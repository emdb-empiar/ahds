<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ahds.grammar &mdash; Amira Header and Data Reader 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Amira Header and Data Reader 0.1 documentation" href="../../index.html" />
    <link rel="up" title="ahds" href="../ahds.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ahds.grammar</h1><div class="highlight"><pre>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># amira_grammar_parser.py</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Grammar to parse headers in Amira files</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>


<span class="c1"># simpleparse</span>
<span class="kn">from</span> <span class="nn">simpleparse.parser</span> <span class="kn">import</span> <span class="n">Parser</span>
<span class="kn">from</span> <span class="nn">simpleparse.common</span> <span class="kn">import</span> <span class="n">numbers</span><span class="p">,</span> <span class="n">strings</span>  <span class="c1"># @UnusedImport</span>
<span class="kn">from</span> <span class="nn">simpleparse.dispatchprocessor</span> <span class="kn">import</span> <span class="n">DispatchProcessor</span><span class="p">,</span> <span class="n">getString</span><span class="p">,</span> <span class="n">dispatchList</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">,</span> <span class="n">singleMap</span><span class="p">,</span> <span class="n">multiMap</span>  <span class="c1"># @UnusedImport</span>


<div class="viewcode-block" id="AmiraDispatchProcessor"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor">[docs]</a><span class="k">class</span> <span class="nc">AmiraDispatchProcessor</span><span class="p">(</span><span class="n">DispatchProcessor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class defining methods to handle each token specified in the grammar&quot;&quot;&quot;</span>
<div class="viewcode-block" id="AmiraDispatchProcessor.designation"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.designation">[docs]</a>    <span class="k">def</span> <span class="nf">designation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;designation&#39;</span><span class="p">:</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)}</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.filetype"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.filetype">[docs]</a>    <span class="k">def</span> <span class="nf">filetype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.dimension"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.dimension">[docs]</a>    <span class="k">def</span> <span class="nf">dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.format"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.format">[docs]</a>    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.version"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.version">[docs]</a>    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span>    </div>
<div class="viewcode-block" id="AmiraDispatchProcessor.extra_format"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.extra_format">[docs]</a>    <span class="k">def</span> <span class="nf">extra_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.comment"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.comment">[docs]</a>    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)}</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.date"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.date">[docs]</a>    <span class="k">def</span> <span class="nf">date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.definitions"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.definitions">[docs]</a>    <span class="k">def</span> <span class="nf">definitions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;definitions&#39;</span><span class="p">:</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)}</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.definition"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.definition">[docs]</a>    <span class="k">def</span> <span class="nf">definition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.definition_name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.definition_name">[docs]</a>    <span class="k">def</span> <span class="nf">definition_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.definition_value"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.definition_value">[docs]</a>    <span class="k">def</span> <span class="nf">definition_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="n">_av</span> <span class="o">=</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_av</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_av</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">_av</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_av</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;definition value list is empty:&#39;</span><span class="p">,</span> <span class="n">_av</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.parameters"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.parameters">[docs]</a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)}</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.parameter"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.parameter">[docs]</a>    <span class="k">def</span> <span class="nf">parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_parameter"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_parameter">[docs]</a>    <span class="k">def</span> <span class="nf">nested_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_parameter_name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_parameter_name">[docs]</a>    <span class="k">def</span> <span class="nf">nested_parameter_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_parameter_values"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_parameter_values">[docs]</a>    <span class="k">def</span> <span class="nf">nested_parameter_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_parameter_value"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_parameter_value">[docs]</a>    <span class="k">def</span> <span class="nf">nested_parameter_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.name">[docs]</a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.attributes"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.attributes">[docs]</a>    <span class="k">def</span> <span class="nf">attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="n">_a</span> <span class="o">=</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_a</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.attribute"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.attribute">[docs]</a>    <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.attribute_name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.attribute_name">[docs]</a>    <span class="k">def</span> <span class="nf">attribute_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.attribute_value"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.attribute_value">[docs]</a>    <span class="k">def</span> <span class="nf">attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="n">_av</span> <span class="o">=</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_av</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_av</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">_av</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_av</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">_av</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;attribute value list is empty:&#39;</span><span class="p">,</span> <span class="n">_av</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_attributes"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">nested_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_attribute"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">nested_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_attribute_name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_attribute_name">[docs]</a>    <span class="k">def</span> <span class="nf">nested_attribute_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_attribute_values"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_attribute_values">[docs]</a>    <span class="k">def</span> <span class="nf">nested_attribute_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="k">return</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_attribute_value"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_attribute_value">[docs]</a>    <span class="k">def</span> <span class="nf">nested_attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_attribute_value_name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_attribute_value_name">[docs]</a>    <span class="k">def</span> <span class="nf">nested_attribute_value_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.nested_attribute_value_value"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.nested_attribute_value_value">[docs]</a>    <span class="k">def</span> <span class="nf">nested_attribute_value_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="n">_av</span> <span class="o">=</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_av</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_av</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">_av</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_av</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">_av</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;nested attribute value list is empty:&#39;</span><span class="p">,</span> <span class="n">_av</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.inline_parameter"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.inline_parameter">[docs]</a>    <span class="k">def</span> <span class="nf">inline_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.inline_parameter_name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.inline_parameter_name">[docs]</a>    <span class="k">def</span> <span class="nf">inline_parameter_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.inline_parameter_value"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.inline_parameter_value">[docs]</a>    <span class="k">def</span> <span class="nf">inline_parameter_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">taglist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;qstring&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.data_pointers"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.data_pointers">[docs]</a>    <span class="k">def</span> <span class="nf">data_pointers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;data_pointers&#39;</span><span class="p">:</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)}</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.data_pointer"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.data_pointer">[docs]</a>    <span class="k">def</span> <span class="nf">data_pointer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">singleMap</span><span class="p">(</span><span class="n">taglist</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.pointer_name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.pointer_name">[docs]</a>    <span class="k">def</span> <span class="nf">pointer_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.data_type"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.data_type">[docs]</a>    <span class="k">def</span> <span class="nf">data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.data_dimension"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.data_dimension">[docs]</a>    <span class="k">def</span> <span class="nf">data_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">))</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.data_name"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.data_name">[docs]</a>    <span class="k">def</span> <span class="nf">data_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.data_index"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.data_index">[docs]</a>    <span class="k">def</span> <span class="nf">data_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">))</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.data_format"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.data_format">[docs]</a>    <span class="k">def</span> <span class="nf">data_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.data_length"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.data_length">[docs]</a>    <span class="k">def</span> <span class="nf">data_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">))</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.hyphname"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.hyphname">[docs]</a>    <span class="k">def</span> <span class="nf">hyphname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.xstring"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.xstring">[docs]</a>    <span class="k">def</span> <span class="nf">xstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.qstring"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.qstring">[docs]</a>    <span class="k">def</span> <span class="nf">qstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.number"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.number">[docs]</a>    <span class="k">def</span> <span class="nf">number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">taglist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">taglist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;float&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">getString</span><span class="p">((</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">)</span></div>
<div class="viewcode-block" id="AmiraDispatchProcessor.number_seq"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.AmiraDispatchProcessor.number_seq">[docs]</a>    <span class="k">def</span> <span class="nf">number_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">taglist</span><span class="p">),</span> <span class="n">buffer_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dispatchList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">taglist</span><span class="p">,</span> <span class="n">buffer_</span><span class="p">)</span></div></div>


<span class="c1"># Amira Header Grammar</span>
<span class="n">amira_header_grammar</span> <span class="o">=</span> <span class="s1">r&#39;&#39;&#39;</span>
<span class="s1">amira                        :=    designation, tsn, comment*, tsn*, definitions, tsn*, parameters*, tsn, data_pointers, tsn</span>

<span class="s1">designation                  :=    (&quot;#&quot;, ts, filetype, ts, dimension*, ts*, format, ts, version, ts*, extra_format*, tsn) / (&quot;#&quot;, ts, filetype, ts, version, ts, format, tsn)</span>
<span class="s1">filetype                     :=    &quot;AmiraMesh&quot; / &quot;HyperSurface&quot;</span>
<span class="s1">dimension                    :=    &quot;3D&quot;</span>
<span class="s1">format                       :=    &quot;BINARY-LITTLE-ENDIAN&quot; / &quot;BINARY&quot; / &quot;ASCII&quot;</span>
<span class="s1">version                      :=    number</span>
<span class="s1">extra_format                 :=    &quot;&lt;&quot;, &quot;hxsurface&quot;, &quot;&gt;&quot;</span>

<span class="s1">comment                      :=    ts, (&quot;#&quot;, ts, &quot;CreationDate:&quot;, ts, date) / (&quot;#&quot;, ts, xstring) , tsn</span>
<span class="s1">date                         :=    xstring</span>

<span class="s1">definitions                  :=    definition*</span>
<span class="s1">definition                   :=    (&quot;define&quot;, ts, definition_name, ts, definition_value) / (&quot;n&quot;, definition_name, ts, definition_value), tsn</span>
<span class="s1">definition_name              :=    hyphname</span>
<span class="s1">definition_value             :=    number, (ts, number)*</span>

<span class="s1">parameters                   :=    &quot;Parameters&quot;, ts, &quot;{&quot;, tsn, parameter*, &quot;}&quot;, tsn</span>
<span class="s1">parameter                    :=    nested_parameter / inline_parameter / comment</span>

<span class="s1">nested_parameter             :=    ts, nested_parameter_name, ts, &quot;{&quot;, tsn, nested_parameter_values, ts, &quot;}&quot;, tsn</span>
<span class="s1">nested_parameter_name        :=    hyphname</span>
<span class="s1">nested_parameter_values      :=    nested_parameter_value* </span>
<span class="s1">nested_parameter_value       :=    ts, name, ts, (&quot;{&quot;, tsn, attributes, ts, &quot;}&quot;) / (&quot;{&quot;, tsn, nested_attributes, ts, &quot;}&quot;) / inline_parameter_value, tsn</span>
<span class="s1">name                         :=    hyphname</span>

<span class="s1">attributes                   :=    attribute*</span>
<span class="s1">attribute                    :=    ts, attribute_name, ts, attribute_value, c*, tsn</span>
<span class="s1">attribute_name               :=    hyphname</span>
<span class="s1">attribute_values             :=    attribute_value*</span>
<span class="s1">attribute_value              :=    (&quot;-&quot;*, &quot;\&quot;&quot;*, ((number, (ts, number)*) / xstring)*, &quot;\&quot;&quot;*)</span>

<span class="s1">nested_attributes            :=    nested_attribute*</span>
<span class="s1">nested_attribute             :=    ts, nested_attribute_name, ts, &quot;{&quot;, tsn, nested_attribute_values, ts, &quot;}&quot;, tsn </span>
<span class="s1">nested_attribute_name        :=    hyphname</span>
<span class="s1">nested_attribute_values      :=    nested_attribute_value*</span>
<span class="s1">nested_attribute_value       :=    ts, nested_attribute_value_name, ts, nested_attribute_value_value, c*, tsn</span>
<span class="s1">nested_attribute_value_name  :=    hyphname</span>
<span class="s1">nested_attribute_value_value :=    &quot;-&quot;*, &quot;\&quot;&quot;*, ((number, (ts, number)*) / xstring)*, &quot;\&quot;&quot;*</span>

<span class="s1">inline_parameter             :=    ts, inline_parameter_name, ts, inline_parameter_value, c*, tsn</span>
<span class="s1">inline_parameter_name        :=    hyphname</span>
<span class="s1">inline_parameter_value       :=    (number, (ts, number)*) / qstring, c*</span>

<span class="s1">data_pointers                :=    data_pointer*</span>
<span class="s1">data_pointer                 :=    pointer_name, ts, &quot;{&quot;, ts, data_type, &quot;[&quot;*, data_dimension*, &quot;]&quot;*, ts, data_name, ts, &quot;}&quot;, ts, &quot;=&quot;*, ts, &quot;@&quot;, data_index, &quot;(&quot;*, data_format*, &quot;,&quot;*, data_length*, &quot;)&quot;*, tsn</span>
<span class="s1">pointer_name                 :=    hyphname</span>
<span class="s1">data_type                    :=    hyphname</span>
<span class="s1">data_dimension               :=    number</span>
<span class="s1">data_name                    :=    hyphname</span>
<span class="s1">data_index                   :=    number</span>
<span class="s1">data_format                  :=    &quot;HxByteRLE&quot; / &quot;HxZip&quot;</span>
<span class="s1">data_length                  :=    number</span>

<span class="s1">hyphname                     :=    [A-Za-z_], [A-Za-z0-9_\-]*</span>
<span class="s1">qstring                      :=    &quot;\&quot;&quot;, [A-Za-z0-9_,.\(\):/ \t]*, &quot;\&quot;&quot;</span>
<span class="s1">xstring                      :=    [A-Za-z], [A-Za-z0-9_\- (\xef)(\xbf)(\xbd)]*</span>
<span class="s1">number_seq                   :=    number, (ts, number)*</span>

<span class="s1"># silent production rules</span>
<span class="s1">&lt;tsn&gt;                        :=    [ \t\n]*            </span>
<span class="s1">&lt;ts&gt;                         :=    [ \t]*</span>
<span class="s1">&lt;c&gt;                          :=    &quot;,&quot;</span>
<span class="s1">&#39;&#39;&#39;</span>


<div class="viewcode-block" id="detect_format"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.detect_format">[docs]</a><span class="k">def</span> <span class="nf">detect_format</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">format_bytes</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Detect Amira file format (AmiraMesh or HyperSurface)</span>
<span class="sd">    </span>
<span class="sd">    :param str fn: file name</span>
<span class="sd">    :param int format_bytes: number of bytes in which to search for the format [default: 50]</span>
<span class="sd">    :param bool verbose: verbose (default) or not</span>
<span class="sd">    :return str file_format: either ``AmiraMesh`` or ``HyperSurface``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">format_bytes</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">verbose</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">rough_header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">format_bytes</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">r&#39;.*AmiraMesh.*&#39;</span><span class="p">,</span> <span class="n">rough_header</span><span class="p">):</span>
            <span class="n">file_format</span> <span class="o">=</span> <span class="s2">&quot;AmiraMesh&quot;</span>
        <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">r&#39;.*HyperSurface.*&#39;</span><span class="p">,</span> <span class="n">rough_header</span><span class="p">):</span>
            <span class="n">file_format</span> <span class="o">=</span> <span class="s2">&quot;HyperSurface&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_format</span> <span class="o">=</span> <span class="s2">&quot;Undefined&quot;</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>  <span class="s2">&quot;{} file detected...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_format</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">file_format</span></div>


<div class="viewcode-block" id="get_header"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.get_header">[docs]</a><span class="k">def</span> <span class="nf">get_header</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">file_format</span><span class="p">,</span> <span class="n">header_bytes</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Apply rules for detecting the boundary of the header</span>
<span class="sd">    </span>
<span class="sd">    :param str fn: file name</span>
<span class="sd">    :param str file_format: either ``AmiraMesh`` or ``HyperSurface``</span>
<span class="sd">    :param int header_bytes: number of bytes in which to search for the header [default: 20000]</span>
<span class="sd">    :return str data: the header as per the ``file_format``</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">header_bytes</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">file_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;AmiraMesh&#39;</span><span class="p">,</span> <span class="s1">&#39;HyperSurface&#39;</span><span class="p">]</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">rough_header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">header_bytes</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">file_format</span> <span class="o">==</span> <span class="s2">&quot;AmiraMesh&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;Using pattern: (?P&lt;data&gt;.*)</span><span class="se">\\</span><span class="s2">n@1&quot;</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r&#39;(?P&lt;data&gt;.*)\n@1&#39;</span><span class="p">,</span> <span class="n">rough_header</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">file_format</span> <span class="o">==</span> <span class="s2">&quot;HyperSurface&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;Using pattern: (?P&lt;data&gt;.*)</span><span class="se">\\</span><span class="s2">nVertices [0-9]*</span><span class="se">\\</span><span class="s2">n&quot;</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">r&#39;(?P&lt;data&gt;.*)\nVertices [0-9]*\n&#39;</span><span class="p">,</span> <span class="n">rough_header</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">file_format</span> <span class="o">==</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unable to parse undefined file&quot;</span><span class="p">)</span>

    <span class="c1"># select the data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="c1">#     print data</span>
<span class="c1">#     print</span>
    
    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="parse_header"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.parse_header">[docs]</a><span class="k">def</span> <span class="nf">parse_header</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse the data using the grammar specified in this module</span>
<span class="sd">    </span>
<span class="sd">    :param str data: delimited data to be parsed for metadata</span>
<span class="sd">    :return list parsed_data: structured metadata </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># the parser</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;Creating parser object...&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">Parser</span><span class="p">(</span><span class="n">amira_header_grammar</span><span class="p">)</span>
    
    <span class="c1"># the processor</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;Defining dispatch processor...&quot;</span>
    <span class="n">amira_processor</span> <span class="o">=</span> <span class="n">AmiraDispatchProcessor</span><span class="p">()</span>
    
    <span class="c1"># parsing</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;Parsing data...&quot;</span>
    <span class="n">success</span><span class="p">,</span> <span class="n">parsed_data</span><span class="p">,</span> <span class="n">next_item</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">production</span><span class="o">=</span><span class="s1">&#39;amira&#39;</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">amira_processor</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;Successfully parsed data...&quot;</span>
        <span class="k">return</span> <span class="n">parsed_data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Parse: {}</span><span class="se">\n</span><span class="s2">Next: {}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">,</span> <span class="n">next_item</span><span class="p">))</span></div>


<div class="viewcode-block" id="get_parsed_data"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.get_parsed_data">[docs]</a><span class="k">def</span> <span class="nf">get_parsed_data</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;All above functions as a single function</span>
<span class="sd">    </span>
<span class="sd">    :param str fn: file name</span>
<span class="sd">    :return list parsed_data: structured metadata</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_format</span> <span class="o">=</span> <span class="n">detect_format</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_header</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">file_format</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">parsed_data</span> <span class="o">=</span> <span class="n">parse_header</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parsed_data</span></div>


<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../ahds.html#ahds.grammar.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">argparse</span>
    
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s1">&#39;amira_grammar_parser&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Parser for Amira headers&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;amira_fn&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;name of an Amira file with extension .am or .surf&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-v&#39;</span><span class="p">,</span> <span class="s1">&#39;--verbose&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;verbose output&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-H&#39;</span><span class="p">,</span> <span class="s1">&#39;--show-header&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;show raw header&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-P&#39;</span><span class="p">,</span> <span class="s1">&#39;--show-parsed&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;show parsed header&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;--format-bytes&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bytes to search for file format&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="s1">&#39;--header-bytes&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bytes to search for header&#39;</span><span class="p">)</span>
    
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># get file format</span>
    <span class="n">file_format</span> <span class="o">=</span> <span class="n">detect_format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">amira_fn</span><span class="p">,</span> <span class="n">format_bytes</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">format_bytes</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
    
    <span class="c1"># get the exact header</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_header</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">amira_fn</span><span class="p">,</span> <span class="n">file_format</span><span class="p">,</span> <span class="n">header_bytes</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">header_bytes</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">show_header</span><span class="p">:</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s1">&#39;raw data:&#39;</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">data</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>

    <span class="c1"># parse the header    </span>
    <span class="n">parsed_data</span> <span class="o">=</span> <span class="n">parse_header</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">show_parsed</span><span class="p">:</span>
        <span class="k">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s1">&#39;parsed data:&#39;</span>
        <span class="n">pprint</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">318</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>

    <span class="k">return</span> <span class="mi">0</span></div>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  <li><a href="../ahds.html">ahds</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Paul K. Korir, PhD.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
    </div>

    

    
  </body>
</html>